<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>广州港集装箱物流信息平台</title>
    <META    HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <META    HTTP-EQUIV="Cache-Control" CONTENT="no-cache">
    <META    HTTP-EQUIV="Expires" CONTENT="0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="/css/themes/metro-white/easyui.css" />
    <link rel="stylesheet" type="text/css" href="/css/themes/metro-white/hdMain.css" />
    <link rel="stylesheet" type="text/css" href="/css/themes/metro-white/hdStyle.css" />
	
    <link rel="stylesheet" type="text/css" href="/css/themes/icon.css" />
    <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico" />

     <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script src="/js/jquery.cycle.all.min.js"></script>
    <script src="/js/jquery.jcarousel.min.js"></script>
    <script src="/js/jquery.easyui.min.js"></script>
    <script src="/js/plugins/jquery.international.js"></script>
    <script type="text/javascript" src="/js/datagrid-bufferview.js"></script>
    <script type="text/javascript" src="/js/highcharts.js"></script>
    <script type="text/javascript" src="/js/jquery.json-2.4.js"></script>
    <script type="text/javascript" src="/js/jquery-migrate-1.2.1.min.js"></script>
    <link type="text/css" rel="stylesheet" href="/login/css/jsmind.css" />
    <script type="text/javascript" src="/js/jsMind/jsmind.js"></script>
    <script type="text/javascript" src="/js/jsMind/jsmind.screenshot.js"></script>
    <script type="text/javascript" src="/js/jsMind/jsmind.draggable.js"></script>

<!--        
		<script charset="utf-8" src="/js/kindeditor/kindeditor-all.js"></script>
		<script charset="utf-8" src="/js/kindeditor/kindeditor.js"></script>
		<script charset="utf-8" src="/js/kindeditor/kindeditor-all-min.js"></script>
		<script charset="utf-8" src="/js/kindeditor/kindeditor-min.js"></script>
 -->
 
 	<script charset="utf-8" src="/js/ueditor/ueditor.config.js"></script>
 	<script charset="utf-8" src="/js/ueditor/ueditor.all.min.js"></script>
 	<script charset="utf-8" src="/js/ueditor/lang/zh-cn/zh-cn.js"></script>
 	<script charset="utf-8" src="/js/ueditor/ueditor.all.js"></script>
	<!-- 百度统计 -->
	<!-- 
	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "https://hm.baidu.com/hm.js?2ddd70b9ed582b28b734c28d3f8b5b81";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
	 -->
    <script type="text/javascript">
        $.hd = $.hd || {};
        $.fn.form.methods.defaultSubmit = $.fn.form.methods.submit || function() {  };
    </script>
    <!-- END: 在公司idev库之前执行 -->
    <script src="/js/hdEzuiEx_js/ezui.ex.tabs.js"></script>
    <script src="/js/hdEzuiEx_js/ezui.ex.combo.js"></script>
    <script src="/js/hdEzuiEx_js/ezui.ex.datagrid.js"></script>
    <script src="/js/hdEzuiEx_js/ezui.ex.form.js"></script>
    <script src="/js/hdEzuiEx_js/ezui.ex.datebox.js"></script>
    <script src="/js/hdEzuiEx_js/ezui.ex.datetimebox.js"></script>
    <script src="/js/hdEzuiEx_js/ezui.ex.combogrid.js"></script>
    <script src="/js/hdEzuiEx_js/ezui.ex.treegrid.js"></script>
    <script src="/js/hdEzuiEx_js/HdObject.js"></script>
    <script src="/js/hdEzuiEx_js/HdConditions.js"></script>
    <script src="/js/hdUtils/HdUtils.js"></script>
    <script src="/js/hdUtils/commonUtils.js"></script>
    <script src="/js/hdEzuiEx_js/HdEzuiQueryParams.js"></script>
    <script src="/js/hdEzuiEx_js/ezuiCode.js" type="text/javascript"></script>
    <script src="/js/hdEzuiEx_js/ezuiComboGridCode.js" type="text/javascript"></script>
    <script type="text/javascript" src="/js/hdEzuiEx_js/extension.js"></script>
    <script type="text/javascript" src="/js/huadong/main.js"></script>
    <script type="text/javascript" src="/js/huadong/hdMenu.js"></script>
    <!-- 下拉 -->
     <script type="text/javascript" src="/js/hdDropList/comboDropListBase.js"></script>
    <!-- BEGIN: 国际化 -->
    <script type="text/javascript"  src="/js/jquery.i18n.properties-min-1.0.9.js"></script>
    <script id="language2" src="/js/hdEzuiEx_js/ezuiEx-lang-zh.js"></script>
    <script id="language" src="/i18n/locale/easyui-lang-zh.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="/css/colorpicker.css"/>
     <script src="/js/colorpicker.js"  type="text/javascript"></script>
     <script src="/js/echarts/build/dist/echarts-all.js"></script>
     <script src="/js/echarts/echarts.min.js"></script>


<script type="text/javascript">


    /*获取浏览器语言*/
    var browserLanguage = "";
    function getBrowserLanguage() {
        $.ajax({
            url: "/webresources/login/AuthUser/findLanguage",
            dataType:"text",
            method: "get",
            async: false,
            success:function(data){
                browserLanguage = data;
            },
            error:function(data){
            }
        });

        
        if (browserLanguage=="zh") {
            return "zh";
        } else if (browserLanguage=="en") {
            return "en";
        }else{
            return "zh";
        }

    }
    function LoadJS(id, fileUrl)
    {
        var scriptTag = document.getElementById(id);
        var oHead = document.getElementsByTagName('HEAD').item(0);
        var oScript = document.createElement("script");
        if (scriptTag)
            oHead.removeChild(scriptTag);
        oScript.id = id;
        oScript.type = "text/javascript";
        oScript.src = fileUrl;
        oHead.appendChild(oScript);
    }
    /*国际化*/
    var language = getBrowserLanguage();
    LoadJS("language2", '../js/hdEzuiEx_js/ezuiEx-lang-' + language + '.js');
    LoadJS("language", '../i18n/locale/easyui-lang-' + language + '.js');
	
    
    var killErrorPrompt = function(errorMessage, scriptURI, lineNumber, columnNumber, errorObj) {}; //屏蔽错误框
    var tabItemHanlder="";//关闭子的句柄
    var upDownTheme="";//定义全局变量，用于上下隐藏按钮
    //    function detectZoom (){    var ratio = 0,     screen = window.screen,     ua = navigator.userAgent.toLowerCase();      if (window.devicePixelRatio !== undefined) {       ratio = window.devicePixelRatio;   }   else if (~ua.indexOf('msie')) {       if (screen.deviceXDPI && screen.logicalXDPI) {       ratio = screen.deviceXDPI / screen.logicalXDPI;     }   }   else if (window.outerWidth !== undefined && window.innerWidth !== undefined) {     ratio = window.outerWidth / window.innerWidth;   }        if (ratio){     ratio = Math.round(ratio * 100);   }        return ratio; };
   

    
    $(document).ready(function() {
    	//KindEditor.basePath = 'alert(window.location.host);js/kindeditor/';
        $("#mainDlg").dialog({closed:true});
        $("#mainDlg2").dialog({closed:true});
        $("#mainDlg3").dialog({closed:true});
        if(browserLanguage=="zh"){
            $("#changeLanguage #optionlanguagefirst").removeAttr("selected");
            $("#changeLanguage #optionlanguagesecond").removeAttr("selected");
            $("#changeLanguage #optionlanguagefirst").attr("selected","selected");
        }else{
            $("#changeLanguage #optionlanguagefirst").removeAttr("selected");
            $("#changeLanguage #optionlanguagesecond").removeAttr("selected");
            $("#changeLanguage #optionlanguagesecond").attr("selected","selected");
        }
        //国际化
        $.i18n.properties({
            name: 'main', //资源文件名称
            path: '../i18n/project/', //资源文件路径
            mode: 'map', //用Map的方式使用资源文件中的值
            language: getBrowserLanguage(),
            callback: function () {//加载成功后设置显示内容
//                        $("label").each(function (i) {
//                            if ($(this).attr("name")) {
//                                $(this).html($.i18n.prop($(this).attr("name")));
//                            }
//                        });
                $("#mainVisitHistory").html($.i18n.prop("main.menu.favorites"));
//                      $("#defaultTabpage").attr("title", $.i18n.prop("clickChange"));
                $("#mainChangeTheme").html($.i18n.prop("main.changeThemes"));
                $("#message").html($.i18n.prop("main.message.msg"));
                $("#logout").html($.i18n.prop("main.logout"));
                $("#fullscreen").html($.i18n.prop("main.fullscreen"));
                //以下3个是为了语言下拉的国际化
                $("#spanlanguage").html($.i18n.prop("main.language"));
                $("#optionlanguagefirst").html($.i18n.prop("main.optionlanguagefirst"));
                $("#optionlanguagesecond").html($.i18n.prop("main.optionlanguagesecond"));
                //原来的超链接的语言的国际化
                /*   $("#changeLanguage").html($.i18n.prop("main.language"));  */
            }
        });

        $('link:first').attr('href', '../css/themes/metro-white/easyui.css');


        //全局默认选项，设置的参数会影响所有的$.ajax请求如$.get()、$.post()、$.ajax等。
        $.ajaxSetup({
            complete: function(XMLHttpRequest, status) {
                var sessionStatus = XMLHttpRequest.getResponseHeader("session-status");
                if(sessionStatus == "timeout"){
                    $.messager.alert("消息", "session超时或服务器重启，需重新登陆", "info", function() {
                        clearInterval(newsRefreshTimer);
                        window.location.replace("<%=request.getContextPath()%>/index.jsp");  //跳转到登录界面
                    });
                }
            }
        });
        //顶部标准功能
        //1 主搜索栏 及卡片控制图标
        $("#mainTabsToolbar .easyui-searchbox").searchbox({
            searcher: function(value, name) {
                $.main.onSeachboxValue(value);
                <!-- 已经封装，每个页面用$.main.registerSeachbox =function(operation,builerOrQueryParam,columns)对查询信息进行注册 -->
            }
        });

        //2 全屏显示功能
        $("#fullscreen").bind('click', function() {
            var el = document.documentElement,
                rfs = el.requestFullScreen || el.webkitRequestFullScreen || el.mozRequestFullScreen || el.msRequestFullScreen,
                wscript;

            if (typeof rfs != "undefined" && rfs) {
                rfs.call(el);
                return;
            }

            if (typeof window.ActiveXObject != "undefined") {
                wscript = new ActiveXObject("WScript.Shell");
                if (wscript) {
                    wscript.SendKeys("{F11}");
                }
            }
        });
        //3 收藏夹功能
        $("#mainVisitHistory").bind('click', function() {
            $("#mainVisitDialog").dialog({
                noheader: false,
                title: '功能收藏',
                closable: true,
                resizable: true,
                width: 360,
                height: 600,
                left: $('#main').width() + $('#main').offset().left - 360,
                top: $('#main').offset().top,
                href: 'system/historyAndFavorite.html',
                modal: false
            });
        });

        //4 换肤功能
        $("#mainChangeTheme").bind('click', function() {
            openTab("皮肤管理",'../login/system/skin.html' , false, null);
        });

        //5 用户按下图标，阅读消息
        $("#message").bind('click', function() {
            var clazz=$(this).attr("class");
            if("headerIconLink1"==clazz){
                openTab("消息",'../login/system/news/NewsReadAndConfirm.html' , false, null);
                //   openTab("noticesend",'../login/system/news/NoticeSend.html' , false, null);

            }else{
                //           openTab("发送消息",'../login/system/news/NewsRelease.html' , false, null);
            }
        });

        //6 左侧菜单隐藏
        $("#moveLeft").bind('click', function() {
            $('#mainBody').layout('collapse', 'west');
            $("#mainMenuDiv").css('display', 'none');
        });

        //7 展开左侧菜单
        $("#mainTwoDiv1").panel({
            onExpand: function() {
                $('#mainBody').layout('expand', 'west');
                $("#mainMenuDiv").css('display', 'block');
            }
        });

        //5 系统管理员修改密码
        $("#updatePassWord201703221715").bind('click', function() {
        	$.get('/login/PrivilegeController/getLoginUserId?t=11&s='+Math.random(), function(data) {
        		modifyPasswordUserId = data;
                HdUtils.dialog.show({title:"密码修改",href:"../login/system/user/password0.html",width:370,height:200,isSaveHandler:true});
            });
        });



        ///8 选择语言 （语言下拉的国际化）
        $("#changeLanguage").on('change',function(){
            var index;
            if(browserLanguage=="zh"){
                index=0;
            }else if(browserLanguage=="en"){
                index=1;
            }else{
                index=0;
            }

            if(index==0){
                browserLanguage="zh";
            }else if(index==1){
                browserLanguage="en";
            }else{
                browserLanguage="zh";
            }
            $.ajax({
                url: "../webresources/login/AuthUser/saveLanguage?language="+browserLanguage,
                dataType:"Json",
                method: "POST",
                async: false,
                success:function(data){
                    location.reload();
                },
                error:function(data){
                }
            });

        });


        // 显示当前登陆用户信息。
        $.get('/login/PrivilegeController/getLoginAccount?t=11&s='+Math.random(), function(data) {
        	if(!data){
                return;
            }
        	$('#updatePassWord201703221715').text(data.name);
            $('#mainCurrentLogin').html("<a href='#' >" + data.name + "</a>");
            $('#mainCurrentLogin a').on('click',function(){
                //openTab('最近访问功能','../login/system/MostRecentUsedPages.html',true);   //未来：打开收藏夹界面
                HdUtils.dialog.show({title: "密码修改", href: "../login/system/user/password.html", width: 290, height: 205, isSaveHandler: true});
            });
            $.main.loginOper=$.extend({},data);  <!-- 保存用于判断权限等，见$.main.isHaveRequiredRole()函数 -->
//           defVistListMenu();
            changeThemByUserInfo(data);
        });

        // 显示当前登陆用户信息。
        function changeThemByUserInfo(data) {
        		if(!data){
                    return;
                }
                onChangeTheme(data.skin);
                upDownTheme=data.skin;
        }

        $('#mainTabsToolbar a[name="btnGoHome"]').on('click', function() {
            $('#main').tabs('select', '首页');
        });

        var upDownFlag="down";
        $('#mainTabsToolbar a[name="btnHideHead"]').on('click', function() {
            var img = $(this).children('img').attr('src');
            if (upDownFlag=="down") {
                $("#mainMenuDiv").addClass('mainLeftUp')
                showOrHideHeader('up');
                upDownFlag="up";
            } else {
                $("#mainMenuDiv").removeClass('mainLeftUp')
                $("#mainMenuDiv").addClass('mainLeft')
                showOrHideHeader('down');
                upDownFlag="down";

            }
        });

        $('#mainTabsToolbar a[name="btnRefresh"]').on('click', function() {
            var tab = $('#main').tabs('getSelected');  // get selected panel
            tab.panel('refresh'); //, 'plugin/' + encodeURI(url)
        });

        $('#mainTabsToolbar a[name="btnCloseIt"]').on('click', function() {
            $.messager.confirm('关闭所有页面','您确认所有数据已存盘，并要关闭全部工作页面?',function(r){
                if (r){
                    var tabsList=$('#main').tabs('tabs');
                    for(var i=tabsList.length-1;i>=0;i--){
                        var tab=$(tabsList[i]);
                        if(tab.size()>0 && $.data(tab[0], "panel")!==undefined){  //未知的原因，tab可能是windows对象而不是tabpage
                            var num=closeTab(tab);
                        }
                    }
                }
            });
            function closeTab(tab){
                var isCloseable = tab.panel('options').closable; //此属性为ezui内部使用的标志
                if (isCloseable !==false) {  //首页等不能关闭
                    var index = $('#main').tabs('getTabIndex', tab);
                    $('#main').tabs('close', index);
                }
            }
        });
        //2主工作区
        $("#main").tabsMain({
            fit: true,
            tools: '#mainTabsToolbar',
            onBeforeClose: function(title, index) {
            	
            	if(tabItemHanlder!=""){
            		doMainTabsCallback(eval(tabItemHanlder),[]); 
            		tabItemHanlder="";
            	}
                $.main.destroyDialogsOnClose($('#main').tabs('getTab', index));
            }
        });
        


       
    });
  //这个方法做了一些操作、然后调用回调函数    
    function doMainTabsCallback(fn,args){    
        fn.apply(this, args);  
    }
  

    //工作方法，关闭banner区
    function showOrHideHeader(val) {
        var header = $('#mainWindowTopbar');
        var logo = header.find('.logo');
        if (val == 'up') {
            header.panel('resize', {height: 1}); //可能panel代码限制，小于10时，height总是10
            logo.css('display', 'none');
            $('#mainTabsToolbar a[name="btnHideHead"] img').attr('src', '/css/themes/'+upDownTheme+'/images/tabIconFullDown.png');
        } else if (val == 'down') {
            header.panel('resize', {height: 55});
            logo.css('display', 'block');
            $('#mainTabsToolbar a[name="btnHideHead"] img').attr('src', '/css/themes/'+upDownTheme+'/images/tabIconFullUp.png');
        }
        $('#mainBody').layout('resize');
    }; //END  showOrHideHeader



    //禁止后退键 ，防止用户按退格导致回到登录页，再回来，当前卡片也关掉了（相当于按了F5刷新）
    $(document).keydown($.main.forbidBackSpace);
    $(document).keypress($.main.forbidBackSpace);
    function onChangeTheme(theme) {
    	if(theme == "null" || theme == "default") {
    		return;
    	}
        $('link').eq(0).attr('href', '../css/themes/' + theme + '/easyui.css');
        $('link').eq(1).attr('href', '../css/themes/' + theme + '/hdMain.css');
        $('link').eq(2).attr('href', '../css/themes/' + theme + '/hdStyle.css');
    } 
</script>
    
</head>

<body class="easyui-layout" id="mainBody" data-options="border:false" >
	<div id="mainWindowTopbar" class="mainHeader" data-options="region:'north',border:false,height:52" >
	    <div class="headerLogo" ></div> 
	    <div class="headerIcon">
		    <a href="/login/PrivilegeController/logout" id="logout" class="headerIconLink5">退出</a>
		    <a href="javascript:void(0)" id="mainChangeTheme" class="headerIconLink3"></a>
		    <a href="javascript:void(0)" id="updatePassWord201703221715" class="headerIconLink7"></a>
	    </div>
	</div>
	
	<div id="mainMenuDiv" class="mainLeft"  style="z-index:9999; width:142px; min-height:500px; height:100%; " >  <!--  必须是layout中的panel -->
	    <div id="col-side">
	
	        <div class="userDiv" id="userDiv">
	          <div class="leftIcon"><a href="#" id="moveLeft"><img src="../images/leftIcon.png" width="20" height="20"  alt=""/></a></div>
	        </div>
	        <div>
	            <ul class="menuUl" id="mainMenu"></ul>
	            <ul class="menuUl"  id="subMenu" style="display:none;"></ul>
	            <div id="menuDownUp" class="menuNext"></div>
	        </div>
	    </div>
	</div>
	
	<div id="mainMenuDiv1"  data-options="region:'west',border:false,title:'菜单导航'" style="width: 142px;z-index:0;" >  <!--  此左侧layout为假写的，目的将center位置挤过去-->
	</div>
	<!-- 工作区卡片 -->
	<div  data-options="region:'center',border:false" style="z-index:0;"> <!-- 这里边再套一层layout实现消息的发布 -->
	    <div class="easyui-layout" data-options="fit:true,border:false"　　　　　　　　　　　　　　　　>
	        <div data-options="region:'center',border:false">   <!-- center 区不能fit否则就把别人挤没了 -->
	            <div id="main" data-options="tools:'#mainTabsToolbar',border:false" >  <!-- fxq 2015-11-17 使用特定的tabs组件 取消class="easyui-tabs"调用仍可使用tabs方法调用 -->
	<!--                 <div id="defaultTabpage1" data-options="title:'首页2',border:false,closable:false,iconCls:'icon-home',fit:true,href:'/login/system/home.html'"> -->
	                <div id="defaultTabpage" data-options="title:'首页',border:false,closable:false,iconCls:'icon-home',fit:true,href:'/login/gisMap/map.html'">
	                    <div id="mainTabsToolbar" style="border:0px; height:20px; top:0px; border:0px; border-bottom: 0px solid #ddd; padding-right:3px;" class="tabs-tool-bottom">
	                        <div>
	                            <a name="btnGoHome" href="#" class="tabIconHome"><img src="/images/tabsIconEmpty.png"/></a>
	                            <a name="btnRefresh" href="#" class="tabIconRefresh"><img src="/images/tabsIconEmpty.png"/></a>
	                            <a name="btnCloseIt" href="#" class="tabIconClose"><img src="/images/tabsIconEmpty.png"/></a>
	                            <a name="btnHideHead" href="#" class="tabIconFullUp"><img src="/images/tabsIconEmpty.png"/></a>
	                        </div>
	                    </div>
	                </div>
	                <div id="Tabhome" data-options="title:'数据分析',border:false,closable:false,fit:true,href:'/login/system/home.html'">
	            </div>
	        </div>
	    </div>
	</div>
	<!--主题列表对话框 -->
	<div id="mainChangeThemeDialog"></div>
	<!--以下独立的DIV -->
	<div id="mainDlg"></div>
	<div id="mainDlg2"></div>
	<div id="mainDlg3" ></div>
	<!--访问列表的下拉菜单 -->
	<div id="mainVisitDialog" >
	</div>
	
	<!--遮罩层，显示flex界面。不放入tabpage页是因为在div.show/HIDE过程中，flex应用频繁初始化 -->
	<div id="swfMaskDiv" style="left:0px;top:0px;width:1px; height:1px; display:block; border:0px;z-index:333333;position:absolute;">
	</div>
</body>
<script type="text/javascript">
	console.log($("#mainMenu"));

</script>


</html>
